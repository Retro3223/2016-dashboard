<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">

        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/c3.css">
        <link rel="stylesheet" type="text/css" href="css/dacss.css">
</head>
<body>

<script src="/js/d3.js" type="text/javascript"></script>
<script src="/js/c3.js" type="text/javascript"></script>
<script src="/js/networktables.js" type="text/javascript"></script>
<!--
<script src="/js/utils.js" type="text/javascript"></script>
-->

<script src="/js/jquery-2.1.3.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.js" type="text/javascript"></script>
<script src="/js/auto.js" type="text/javascript"></script>
<script src="/js/stuff.js" type="text/javascript"></script>
<script src="/js/cameras.js" type="text/javascript"></script>
<script src="/js/params.js" type="text/javascript"></script>
<script src="/js/joystick.js" type="text/javascript"></script>

<div id='Main' style="margin: 10px">
    <ul id='tabs' class="nav nav-tabs" role="tablist">
        <li role="presentation">
            <a href="#teleop">Teleop</a>
        </li>
        <li role="presentation" class="active">
            <a href="#auto">Auto</a>
        </li>
        <li role="presentation"> 
            <a href="#params">Parameters</a>
        </li>
        <li role="presentation">
            <a href="#other">Scratch space</a>
        </li>
		<li role="presentation">
            <a href="#joysticks">Joysticks</a>
        </li>
    </ul>
    <div id="Content" class="tab-content">
        <div role="tabpanel" class="tab-pane" id="teleop">
            <div class="container">
                <div class="row">
					<div class="col-md-1">
								<img src="/img/minibot.png" class='minibot'/>
					</div>
                    <div class="col-md-4">
                        <div class="row">       
                            <div id="webcam0_stream" class="camera">
                                <img class='no-signal' src="/img/indianfront.png"/>
                                <img class='signal' />
                            </div>
                        </div>
                        <div class="row">
							<div class='col-md-7'>
                                Camera:
                                <select id='leftFrameCamera'>
                                    <option value="front">Front</option>
                                    <option value="back">Back</option>
                                    <option value="structure">Structure</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                            <!--
                            <div class='col-md-2'>
                                Drive
                                <button class="btn btn-success">
                                    ??
                                </button>        
                            </div>
                            -->
                        </div>
                            
                    </div>                   
                    <div class="col-md-5">
                        <div class="row">
                            <div id="webcam1_stream" class="camera">
                                <img class='no-signal' src="/img/indianback.png"/>
                                <img class='signal' />
                            </div>
                        </div>
                        <div class="row">
                            <div class='col-md-7'>
                                Camera:
                                <select id='rightFrameCamera'>
                                    <option value="front">Front</option>
                                    <option value="back">Back</option>
                                    <option value="structure">Structure</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-primary btn-lg btn-size">
                            Shoot
                        </button>
                        <button id="SuckerBtn" class="btn btn-primary btn-lg btn-size">
                            Slurp
                        </button>
                        <div id='Compass' class='compass col-md-2'>
                            <img class='windrose' src='/img/windrose.svg' />
                            <img class='arrow compasssize' src='/img/dragoncompass.png'/>
                            <span id='CompassDisplay' class='display'></span>
                        </div>
                     </div>
                </div>

                <div class="row">
                    <div class="col-md-3">
                        <button class="btn btn-danger btn-lg btn-size">
                            Low Bar
                        </button>
                        <button class="btn btn-danger btn-lg btn-size">
                            Rock Wall
                        </button>
                    </div>
                    <div class="col-md-3">
                    		<button class="btn btn-danger btn-lg btn-size">
                            Rough Terrain
                        </button>
                        <button class="btn btn-danger btn-lg btn-size">
                            Chili Fries
                        </button>
                    </div>
                    <div class="col-md-3">
                    		<button class="btn btn-danger btn-lg btn-size">
                            Moat
                        </button>
                        <button class="btn btn-danger btn-lg btn-size">
                            Portcullis
                        </button>
                    </div>
                    <div class="col-md-3">
                    		<button class="btn btn-danger btn-lg btn-size">
                    			 Rampart
                    		</button>
                    </div>
                </div>            
             </div>   
        </div>
        <div role="tabpanel" class="tab-pane active"  id="auto">
            <div>
                <span id="autoConnectionWarning">
                    <i class='glyphicon glyphicon-alert'></i>
                    Websocket not connected. Robot's autonomous mode may be 
                    different than what is shown below.
                    <br>
                </span>
                <span id="autoRobotConnectionWarning">
                    <i class='glyphicon glyphicon-alert'></i>
                    Robot not connected. Robot's autonomous mode may be 
                    different than what is shown below.
                </span>
            </div>
            <label class="auto-option">
            	<label>
            	 <input type="radio" name="autochoice" value="lowbar"/>
            	Low Bar
            	</label>
            	<div class="pull-right">
            		<img src="/img/lowbar.jpg"/>
            	</div>
            </label>
            <label class="auto-option">
            	<label>
            	 <input type="radio" name="autochoice" value="roughterrain"/>
            	Rough Terrain
            	</label>
            	<div class="pull-right">
            		<img src="/img/roughterrain.jpg"/>
            	</div>
            </label>
            <label class="auto-option">
            	<label>
            	 <input type="radio" name="autochoice" value="moat"/>
            	Moat
            	</label>
            	<div class="pull-right">
            		<img src="/img/moat.jpg"/>
            	</div>
            </label>
            <label class="auto-option">
            	<label>
            	 <input type="radio" name="autochoice" value="rampart"/>
            	Rampart
            	</label>
            	<div class="pull-right">
            		<img src="/img/rampart.jpg"/>
            	</div>
            </label>
            <label class="auto-option">
            	<label>
            	 <input type="radio" name="autochoice" value="rockwall"/>
            	Rock Wall
            	</label>
            	<div class="pull-right">
            		<img src="/img/rockwall.jpg"/>
            	</div>
            </label>
		</div>	
        <div role="tabpanel" class="tab-pane" id="params">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th style="width:40%"></th>
                        <th style="width:30%"></th>
                        <th style="width:30%"></th>
                    </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Arm pitch up speed:</td>
                    <td>
                        <input id="arm_pitch_up_speed" type="text"/>
                    </td>
                </tr>
                <tr>
                    <td>Arm pitch down speed:</td>
                    <td>
                        <input id="arm_pitch_down_speed" type="text"/>
                    </td>
                </tr>
                <tr>
                    <td>Arm roller out speed:</td>
                    <td>
                        <input id="arm_roller_out_speed" type="text"/>
                    </td>
                </tr>
                <tr>
                    <td>Arm roller in speed:</td>
                    <td>
                        <input id="arm_roller_in_speed" type="text"/>
                    </td>
                </tr>
                <tr>
                    <td>Desired heading:</td>
                    <td>
                        <input id="desired_heading" type="text"/>
                    </td>
                </tr>
                <tr>
                    <td>Rotate velocity:</td>
                    <td>
                        <input id="rotate_velocity" type="text"/>
                    </td>
                </tr>
                <tr>
                    <td>Rotate mode:</td>
                    <td>
                        <input id="rotate_mode" type="text"/>
                    </td>
                </tr>
            </table>
        </div>
        <div role="tabpanel" class="tab-pane" id="other">
            <div>
                NetworkTables websocket: <span id="connectstate">Unknown state</span><br/>
                Robot: <span id="robotstate">Unknown state</span>
            </div>
            <hr/>


            <div id="chart">
            </div>
            
            <table id="nt" class="table table-striped">
                <tbody></tbody>
            </table>
        </div>
        <div role="tabpanel" class="tab-pane" id="joysticks">
			<div id="stick_row" class="row">
				<div id="left_stick" class="joystick col-md-6">
					<img class="center" src="/img/stickofjoy.png"/>
					<span id= "left_1_container">
					<span id="left_1_label">Btn1:</span>
					<span id = "left_1"></span>
				</span>
				<span id= "left_2_container">
					<span id="left_2_label">Btn2:</span>
					<span id = "left_2"></span>
				</span>
				<span id= "left_3_container">
					<span id="left_3_label">Btn3:</span>
					<span id = "left_3"></span>
				</span>
				<span id= "left_4_container">
					<span id="left_4_label">Btn4:</span>
					<span id = "left_4"></span>
				</span>
				<span id= "left_5_container">
					<span id="left_5_label">Btn5:</span>
					<span id = "left_5"></span>
				</span>
				<span id= "left_6_container">
					<span id="left_6_label">Btn6:</span>
					<span id = "left_6"></span>
				</span>
				<span id= "left_7_container">
					<span id="left_7_label">Btn7:</span>
					<span id = "left_7"></span>
				</span>
				<span id= "left_8_container">
					<span id="left_8_label">Btn8:</span>
					<span id = "left_8"></span>
				</span>
				<span id= "left_9_container">
					<span id="left_9_label">Btn9:</span>
					<span id = "left_9"></span>
				</span>
				<span id= "left_10_container">
					<span id="left_10_label">Btn10:</span>
					<span id = "left_10"></span>
				</span>
				<span id= "left_11_container">
					<span id="left_11_label">Btn11:</span>
					<span id = "left_11"></span>
				</span>
				</div>
				<div id="right_stick" class="joystick col-md-6">
					<img class = "center" src="/img/stickofjoy.png"/>
					<span id= "right_1_container">	
						<span id="right_1_label">Btn1</span>
						<span id = "right_1"></span>
					</span>
					<span id= "right_2_container">	
						<span id="right_2_label">Btn2</span>
						<span id = "right_2"></span>
					</span>
					<span id= "right_3_container">	
						<span id="right_3_label">Btn3</span>
						<span id = "right_3"></span>
					</span>
					<span id= "right_4_container">	
						<span id="right_4_label">Btn4</span>
						<span id = "right_4"></span>
					</span>
					<span id= "right_5_container">	
						<span id="right_5_label">Btn5</span>
						<span id = "right_5"></span>
					</span>
					<span id= "right_6_container">
						<span id="right_6_label">Btn6</span>
						<span id = "right_6"></span>
					</span>
					<span id= "right_7_container">	
						<span id="right_7_label">Btn7</span>
						<span id = "right_7"></span>
					</span>
					<span id= "right_8_container">	
						<span id="right_8_label">Btn8</span>
						<span id = "right_8"></span>
					</span>
					<span id= "right_9_container">	
						<span id="right_9_label">Btn9</span>
						<span id = "right_9"></span>
					</span>
					<span id= "right_10_container">	
						<span id="right_10_label">Btn10</span>
						<span id = "right_10"></span>
					</span>
					<span id= "right_11_container">
						<span id="right_11_label">Btn11</span>
						<span id = "right_11"></span>
					</span>
				</div>
			</div>
		</div>
    </div>
</div>
<script type="text/javascript">
"use strict";
var chart;
var data = ['y'];
var dataChanged = false;
var maxSize = 1000 / 20 * 30;


$(document).ready(function() {
        setupNetworkTables();
        //setupChart();
        
   $("#SuckerBtn").click(function() {
   	
   });
   
});

function autonomousOver() {
	$("#tabs>li").removeClass("active");
	$("#tabs>li:nth-child(1)").addClass("active");
	
	$("#Content>div").removeClass("active");
	$("#Content>#teleop").addClass("active");
	
}

function setupNetworkTables() {
    NetworkTables.addWsConnectionListener(onNetworkTablesConnection, true);
    NetworkTables.addRobotConnectionListener(onRobotConnection, true);
    NetworkTables.addGlobalListener(onValueChanged, true);
}

function setupChart() {
    chart = c3.generate({data:{columns:[data]}});
    setInterval(chartRefresh, 200);
}


function onRobotConnection(connected) {
    $('#robotstate').text(connected ? "Connected!" : "Disconnected");
}

function onNetworkTablesConnection(connected) {
    if (connected) {
            $("#connectstate").text("Connected!");
            $("#nt tbody > tr").remove();
    } else {
        $("#connectstate").text("Disconnected!");
    }
}

function chartRefresh() {
    if(dataChanged) {
        chart.load ({
            columns:[data]
        });
        dataChanged = false;
    }
}

function onValueChanged(key, value, isNew) {
	if (isNew) {
		var tr = $('<tr></tr>').appendTo($('#nt > tbody:last'));
		$('<td></td>').text(key).appendTo(tr);
		$('<td></td>').attr('id', NetworkTables.keyToId(key))
					   .text(value)
					   .appendTo(tr);

		
	} else {
	
		// similarly, use keySelector to convert the key to a valid jQuery
		// selector. This should work for class names also, not just for ids
		$('#' + NetworkTables.keySelector(key)).text(value);

            if (key=== "/SmartDashboard/angle"){
                dataChanged = true;
                var c = data.shift();
                data.unshift(value);
                data.unshift(c);
                if (data.length >= maxSize){			
                        data.pop();
                }
                $("#Compass .arrow").css("transform", "rotate(" + value + "deg)");
                $("#CompassDisplay").text(value + " degrees");
            }

	}
	
	if (key === "/SmartDashboard/autonomousOver") {
		autonomousOver();	
	}
}

</script>

</body>
</html>
